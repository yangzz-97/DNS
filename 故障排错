缓存名称服务器虽然能降低DNS服务器的工作负载以及提高DNS的性能，但是当缓存中的数据不是最新的，会导致客户端收到的dns响应不准确，就会增加生产环境上的故障点

在开始故障排查之前，首先要确定正在使用的名称解析机制，而不是直接从DNS开始。glibc-common软件包提供的getent命令以及syslinux软件包提供的gethostip命令都可以用于执行名称解析。
如果getent和gethostip的结果不同于dig命令产生的结果，那么明确表明并非DNS的问题。
需要去查看/etc/nsswitch.conf文件，确认是否使用其他名臣解析机制

排错可能的原因：
1、网络的原因：
如果使用dig命令没有从dns服务器得到响应，说明就是客户端和服务端之间网络存在问题。
一个可能的原因是配置了错误的DNS服务器ip地址。如果系统是客户端，则不正确的地址可能在/etc/resolv.conf；如果系统被配置成unbound缓存服务器，则不正确的地址可能出现在/etc/unbound/unbound.conf的forward-zone子句中

另一个可能的原因是防火墙没有放行dns服务或者没有放行53端口的流量。

2、如果网络没问题，使用dig命令就能查看到更详细的输出。在dig输出的HEADER部分中的status字段，显示的是相应代码

响应代码种类：
（1）SERVFAIL：名称服务器在处理查询时出现问题
可能的原因是DNS服务器无法与正在查询的名称有权威的名称服务器之间进行通信，这可能是由于权威名称服务器不可用。
还有可能就是网络层的问题，DNS服务器与权威名称服务器之间的通信不可达，可能是路由原因或者防护墙的原因。
可使用dig的+trace选项，可以确认每个名称服务器的迭代查询结果（从根名称服务器开始）

（2）NXDOMAIN：查询名称在域中不存在


（3）REFUSED：由于策略限制，名称服务器拒绝了客户端的DNS请求
这种情况要到dns服务器上查看是否配置了策略不允许某些客户端进行访问。



其他常见DNS问题：
1、查询到的数据是缓存中过期的数据，不是最新的

2、区域中存在使用通配符（*）记录

3、缺少PTR记录
